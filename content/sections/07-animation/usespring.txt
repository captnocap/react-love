=== METADATA ===
title: useSpring
description: Convenience hook that automatically springs to a target value when it changes.
category: Animation
platforms: love2d, web, terminal, cc, nvim, hs, awesome
keywords: useSpring, hook, spring, physics, animation, automatic, convenience, stiffness, damping, mass
related: useanimation.txt, usetransition.txt, animatedvalue.txt
difficulty: beginner

=== OVERVIEW ===
useSpring is a convenience hook that automatically starts a spring animation whenever its
target value changes. It is the simplest way to add spring-based motion to a component --
you provide the target value and optional spring configuration, and the hook returns the
current interpolated value that updates each frame.

The hook skips animation on the first render (the value starts at the target immediately).
On subsequent renders where the target changes, a spring animation is started to
transition from the current value to the new target.

=== API / SYNTAX ===
Signature:
  function useSpring(targetValue: number, config?: { stiffness?: number; damping?: number; mass?: number }): number

Parameters:
  targetValue: number
    The value to spring towards. When this changes, a new spring animation starts.

  config?: object (optional)
    stiffness?: number   Spring stiffness. Higher = snappier. Default: 100
    damping?: number     Damping coefficient. Higher = less oscillation. Default: 10
    mass?: number        Mass of the object. Higher = slower/heavier. Default: 1

Returns:
  number
    The current interpolated value. Updates each animation frame, triggering re-render.

Spring behavior:
  - stiffness controls how strongly the spring pulls toward the target
  - damping controls how quickly oscillation settles
  - mass controls how heavy the animated object feels
  - Low damping + high stiffness = bouncy
  - High damping + low stiffness = sluggish
  - The animation uses Verlet integration with clamped dt (max 64ms) to avoid instability

=== EXAMPLES ===
Example 1: Toggle width
---
import { useState } from 'react';
import { useSpring, Box, Text } from '@ilovereact/core';

function ExpandableBox() {
  const [expanded, setExpanded] = useState(false);
  const width = useSpring(expanded ? 300 : 100);

  return (
    <Box style={{ width: '100%', height: '100%', padding: 20 }}>
      <Box
        style={{ width, height: 80, backgroundColor: '#89b4fa', borderRadius: 8 }}
        onClick={() => setExpanded(!expanded)}
      >
        <Text style={{ fontSize: 16, color: '#1e1e2e' }}>
          {expanded ? 'Collapse' : 'Expand'}
        </Text>
      </Box>
    </Box>
  );
}
---
Platforms: All

Example 2: Bouncy spring
---
import { useState } from 'react';
import { useSpring, Box } from '@ilovereact/core';

function BouncyButton() {
  const [pressed, setPressed] = useState(false);
  const scale = useSpring(pressed ? 0.85 : 1.0, { stiffness: 400, damping: 8, mass: 0.5 });

  return (
    <Box
      style={{
        width: 120,
        height: 120,
        backgroundColor: '#f38ba8',
        borderRadius: 60,
        transform: { scaleX: scale, scaleY: scale },
      }}
      onClick={() => setPressed(!pressed)}
    />
  );
}
---
Platforms: All

Example 3: Smooth height transition
---
import { useState } from 'react';
import { useSpring, Box, Text } from '@ilovereact/core';

function AccordionItem({ title, content }: { title: string; content: string }) {
  const [open, setOpen] = useState(false);
  const height = useSpring(open ? 120 : 0, { stiffness: 200, damping: 25 });

  return (
    <Box style={{ width: '100%' }}>
      <Box
        style={{ width: '100%', height: 40, backgroundColor: '#313244', padding: 8 }}
        onClick={() => setOpen(!open)}
      >
        <Text style={{ fontSize: 16, color: '#cdd6f4' }}>{title}</Text>
      </Box>
      <Box style={{ width: '100%', height, overflow: 'hidden', backgroundColor: '#1e1e2e' }}>
        <Box style={{ padding: 8 }}>
          <Text style={{ fontSize: 14, color: '#a6adc8' }}>{content}</Text>
        </Box>
      </Box>
    </Box>
  );
}
---
Platforms: All

=== PLATFORM NOTES ===
Works identically on all platforms. Uses useAnimation internally, which handles the
requestAnimationFrame / setTimeout fallback.

=== CRITICAL RULES ===
- Animation is skipped on first render -- value starts at targetValue immediately
- A new spring animation starts every time targetValue changes
- The previous animation is automatically stopped when a new one starts
- Config changes do NOT restart the animation -- only targetValue changes trigger animation
- Config is read from a ref at animation start time, so it can be dynamic
- The returned value triggers React re-render every animation frame

=== SEE ALSO ===
- usetransition.txt -- Timing-based convenience hook (alternative to spring)
- useanimation.txt -- Full control over AnimatedValue
- animatedvalue.txt -- AnimatedValue spring configuration details
