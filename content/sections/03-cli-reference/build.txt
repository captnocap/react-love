=== METADATA ===
title: ilovereact build
description: Bundle JS for development or produce self-contained distribution packages.
category: CLI
platforms: love2d, terminal
keywords: build, bundle, dist, love, terminal, self-extracting, binary, esbuild, lint gate
related: dev.txt, update.txt, lint.txt
difficulty: intermediate

=== OVERVIEW ===
The `ilovereact build` command bundles JavaScript and optionally produces self-contained
distribution packages. Without a target, it runs the lint gate and bundles JS for the
`love .` dev workflow. With a target (dist:love or dist:terminal), it produces a standalone
executable.

Every build automatically runs `ilovereact update` first (unless --no-update) and passes
through the lint gate -- builds fail on lint errors. This ensures that distribution packages
always contain up-to-date framework files and pass layout validation.

=== API / SYNTAX ===
Usage:
  ilovereact build [target] [flags]

Targets:
  (none)          Lint gate + bundle JS for dev (outputs bundle.js for `love .` workflow)
  dist:love       Self-extracting Linux binary with bundled glibc, Love2D, and QuickJS
  dist:terminal   Single-file Node.js executable with shebang

Flags:
  --no-update     Skip the automatic `ilovereact update` step
  --debug         Enable the visual inspector (F12) in dist:love builds
                  (inspector is disabled by default in dist builds)

Build steps for each target:

  No target (dev bundle):
    1. ilovereact update (sync runtime files)
    2. Lint gate (fail on errors)
    3. esbuild --format=iife --global-name=ReactLove
    4. Output: bundle.js

  dist:love:
    1. ilovereact update
    2. Bundle JS (IIFE for QuickJS)
    3. Stage .love archive (main.lua, conf.lua, lua/, bundle.js)
    4. Create .love zip archive
    5. Bundle Love2D binary + all shared libraries (including glibc)
    6. Create launcher script
    7. Pack into single self-extracting binary
    8. Output: dist/<project-name>
    Entry: src/main-love.tsx or src/native-main.tsx or src/main.tsx (first found)

  dist:terminal:
    1. Bundle JS (CJS for Node.js, --platform=node, --external:ws)
    2. Prepend shebang (#!/usr/bin/env node)
    3. Output: dist/<project-name>-terminal
    Entry: src/main-terminal.tsx

=== EXAMPLES ===
Example 1: Dev bundle
---
ilovereact build
love .
---
Platforms: love2d

Example 2: Self-extracting Love2D binary
---
ilovereact build dist:love
./dist/my-app
---
Platforms: love2d

Example 3: Debug build with inspector
---
ilovereact build dist:love --debug
---
Platforms: love2d

Example 4: Terminal executable
---
ilovereact build dist:terminal
./dist/my-app-terminal
---
Platforms: terminal

Example 5: Skip runtime update
---
ilovereact build --no-update
---
Platforms: love2d

=== PLATFORM NOTES ===
dist:love: Produces a self-extracting binary for x86_64 Linux. Bundles ALL shared libraries
from the host system (same technique as Steam Runtime / AppImage), including glibc and the
dynamic linker. The binary extracts to ~/.cache/ilovereact-<name>/ and uses an MD5 signature
to avoid re-extraction on subsequent runs. Requires Love2D and ldd to be available on the
build system.

dist:terminal: Produces a single-file Node.js executable. Uses CJS format (not ESM) to
avoid module warnings. The ws package is marked as external.

=== CRITICAL RULES ===
- Build always runs the lint gate -- fix all lint errors before building
- Build always runs `ilovereact update` unless --no-update is passed
- The inspector (F12) is automatically disabled in dist:love builds (pass --debug to keep it)
- dist:love only works on x86_64 Linux (bundles host system's glibc and shared libraries)
- dist:love requires Love2D installed on the build machine
- Never run raw esbuild manually -- the CLI encodes correct flags for each target

=== SEE ALSO ===
- dev.txt -- Watch mode for iterative development
- lint.txt -- Lint gate details
- update.txt -- Runtime file sync
- screenshot.txt -- Visual verification before building
